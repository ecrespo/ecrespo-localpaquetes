<HTML>
<HEAD>
<title>DWL-G730</title>
<META HTTP-EQUIV=Content-Type CONTENT="text/html; charset=iso-8859-1">
<script language="JavaScript" src="public.js"></script>
<script language="JavaScript">
var SelRow = -1
MaxRow = 1
rDat = new Array()
rDat[1] = "3,v,1,Allow to Ping WAN port,0,1,*,,0,192.168.0.30,,1,8,,0,1,0,0,1,0,0,0,0"
rDat[2] = "2,p,1,Default,1,-1,*,,0,*,,0,*,,0,1,0,0,1,0,0,0,0"
rDat[3] = "1,p,1,Default,0,0,*,,-1,*,,0,*,,0,1,0,0,1,0,0,0,0"

function GetIf(i){
	if (i=="-1") return 0
	if (i=="0") return 1
	return 2
}
function GetRuleProto(p){
 var i = 3
 if (p=="6") i=0
 else if (p=="17") i=1
 else if (p=="1") i=2
	return i
}
function DisProto(f,d){
	f.enable[0].disabled = f.enable[1].disabled = f.action[0].disabled = f.action[1].disabled = f.name.disabled = f.proto.disabled = f.port1.disabled = f.port2.disabled = d
}
function DisSrc(f,d){
	f.srcIface.disabled = f.srcIP1.disabled = f.srcIP2.disabled = d
	DisProto(f,d)
}
function DisDst(f,d){
	f.dstIface.disabled = f.dstIP1.disabled = f.dstIP2.disabled = d
	DisProto(f,d)
}
function DisTab(f,d){
	DisSrc(f,false)
	DisDst(f,false)
	if (d=="p"){
	DisSrc(f,true)
	f.dstIface.disabled = true
	}
	else if (d=="i"){
	DisSrc(f,true)
	f.dstIface.disabled = true
	}
	else if (d=="v"){
	DisDst(f,true)
	f.srcIface.disabled = true
	}
}
function DisRow(f,i){
	var d = rDat[i].split(",")
	DisTab(f,d[1])
	SelectRow("tabRule",i)
}
function RuleNew(){
	var f = document.getElementById("frmRule")
	DisTab(f,"r")
	NewRow(f,"tabRule")
}
function RuleReload(){
	var f = document.getElementById("frmRule")
	var i = parseInt(f.editRow.value)
	if (i>=1) DisRow(f,i)
}
function EditRow(row){
	var f = document.getElementById("frmRule")
	f.editRow.value = row
	var d = rDat[row].split(",")
	f.serial.value = d[0]
	f.enable[0].checked = d[2]=="1"
	f.enable[1].checked = d[2]=="0"
	f.name.value = d[3]
	f.action[0].checked = d[4]=="0"
	f.action[1].checked = d[4]=="1"
	f.srcIface.selectedIndex = GetIf(d[5])
	f.srcIP1.value = d[6]
	f.srcIP2.value = d[7]
	f.dstIface.selectedIndex = GetIf(d[8])
	f.dstIP1.value = d[9]
	f.dstIP2.value = d[10]
	f.proto.selectedIndex = GetRuleProto(d[11])
	f.port1.value = d[12]
	f.port2.value = d[13]
 GetSchedule(f, d, 14)
	DisRow(f,row)
}
function ChgPri(row,off)
{
	EditRow(row)
	var f = document.getElementById("frmRule")
	var newrow = SelRow+off
	if (SelRow>=MaxRow || newrow<=0 || newrow>=MaxRow)
	return
	var t = document.getElementById("tabRule")
	var n = t.rows[newrow], s=t.rows[SelRow]
	var i
	for (i=1;i<n.cells.length;i++){
	d = n.cells[i].childNodes[0].data
	n.cells[i].childNodes[0].data = s.cells[i].childNodes[0].data
	s.cells[i].childNodes[0].data = d
	}
	var r = rDat[SelRow]
	rDat[SelRow] = rDat[newrow]
	rDat[newrow] = r
	var e = r.split(",")
	eval("f.e"+newrow+".checked="+(e[1]=="1" ? "true" : "false"))
	e = rDat[SelRow].split(",")
	eval("f.e"+SelRow+".checked="+(e[1]=="1" ? "true" : "false"))
	f.priorList.value=""
	for (i=1;i<MaxRow;i++){
	e = rDat[i].split(",")
	f.priorList.value += (e[0]+",")
	}
	SelectRow("tabRule",newrow)
}
function UpdatePrior(f){
 f.priorList.value=""
 for (i=1;i<MaxRow;i++){
 e = rDat[i].split(",")
 f.priorList.value += (e[0]+",")
 }
}
</script>
</HEAD>
<BODY BGCOLOR=#FFFFFF leftmargin="0" topmargin="0" onLoad="RuleReload()">
<table width="75%" border="0" cellspacing="0" cellpadding="0" align="center">
 <tr>
 <td>
 <div align="center"><img src="home_01.jpg" width="765" height="95" usemap="#Map2" border="0"></div>
 </td>
 </tr>
 <tr>
 <td>
 <table width=765 border=0 cellpadding=0 cellspacing=0 align="center">
 <tr> 
 <td rowspan=9 width="20" background="down_01.gif">&nbsp; </td>
 <td rowspan=2 width="133"> <img src="down_02.jpg" width=133 height=75></td>
 <td rowspan=2 width="25" background="down_03.jpg">&nbsp; </td>
 <td width="21"> <img src="advhtml_04.jpg" width=21 height=49></td>
 <td width="522"> <img src="advhtml_05.jpg" width=522 height=49 usemap="#MapMap" border="0"></td>
 <td width="19"> <img src="down_06.jpg" width=19 height=49></td>
 <td width="25" background="down_11.gif">&nbsp; </td>
 </tr>
 <tr> 
 <td width="21" background="down_14.gif">&nbsp; </td>
 <td rowspan=8 width="522" valign="top"> 
 <form action="rule.cgi" method="post" id="frmRule">
 <table width="100%" border="0" cellpadding="0">
 <tr> 
 <td colspan="6"><font color="#8bacb1" face="Arial" size="2"><b>Firewall 
 Rules</b></font></td>
 </tr>
 <tr valign="top"> 
 <td colspan="6" height="30"><font face="Arial" size="2">Firewall 
 Rules can be used to allow or deny traffic from passing through 
 the DWL-G730.</font></td>
 </tr>
 <tr> 
 <td width="14%">&nbsp; </td>
 <td colspan="5"> <font face="Arial" size="2"> 
 <input type="radio" name="enable" value="1">
 Enabled 
 <input type="radio" name="enable" value="0">
 Disabled 
 <input type="hidden" name="serial" value="0">
 <input type="hidden" name="priorList" value="">
 <input type="hidden" name="editRow" value="-1">
 <font size="2" face="Arial"> 
 <input type="hidden" name="delrow" value="0">
 </font> </font></td>
 </tr>
 <tr> 
 <td width="14%"> 
 <div align="left"><font face="Arial" size="2">Name&nbsp;</font></div>
 </td>
 <td colspan="5"> <font face="Arial" size="2"> 
 <input type="text" name="name" size="20" maxlength="31" value="">
 <input type="reset" value="Clear" onClick="RuleNew()" name="clear">
 </font></td>
 </tr>
 <tr> 
 <td width="14%"> 
 <div align="left"><font face="Arial" size="2">Action&nbsp;</font></div>
 </td>
 <td colspan="5"><font face="Arial" size="2"> 
 <input type="radio" value="0" name="action">
 Allow 
 <input type="radio" name="action" value="1">
 Deny</font></td>
 </tr>
 <tr> 
 <td width="14%"> 
 <div align="left"></div>
 </td>
 <td width="12%"><font face="Arial" size="2">Interface</font></td>
 <td width="17%"><font face="Arial" size="2">IP Range Start</font></td>
 <td width="16%"><font face="Arial" size="2">IP Range End</font></td>
 <td width="12%"><font face="Arial" size="2">Protocol</font></td>
 <td width="29%"><font face="Arial" size="2">Port Range </font></td>
 </tr>
 <tr> 
 <td width="14%"> 
 <div align="left"><font face="Arial" size="2">Source&nbsp;</font></div>
 </td>
 <td width="12%"><font face="Arial" size="2"> 
 <select size="1" name="srcIface">
 <option value="-1">*</option>
 <option value="0">LAN</option>
 <option value="1">WAN</option>
 </select>
 </font></td>
 <td width="17%"><font face="Arial" size="2"> 
 <input type="text" name="srcIP1" size="12" value="" maxlength="15">
 </font></td>
 <td colspan="3"><font face="Arial" size="2"> 
 <input type="text" name="srcIP2" size="12" value="" maxlength="15">
 </font></td>
 </tr>
 <tr> 
 <td width="14%"> 
 <div align="left"><font face="Arial" size="2">Destination&nbsp;</font></div>
 </td>
 <td width="12%"><font face="Arial" size="2"> 
 <select size="1" name="dstIface">
 <option value="-1">*</option>
 <option value="0">LAN</option>
 <option value="1">WAN</option>
 </select>
 </font></td>
 <td width="17%"><font face="Arial" size="2"> 
 <input type="text" name="dstIP1" size="12" maxlength="15" value="">
 </font></td>
 <td width="16%"><font face="Arial" size="2"> 
 <input type="text" name="dstIP2" size="12" maxlength="15" value="">
 </font></td>
 <td width="12%"><font face="Arial" size="2"> 
 <select size="1" name="proto">
 <option value="6">TCP</option>
 <option value="17">UDP</option>
 <option value="1">ICMP</option>
 <option value="0">*</option>
 </select>
 </font></td>
 <td width="29%"><font face="Arial" size="2"> 
 <input type="text" name="port1" size="2" maxlength="5" value="">
 - 
 <input type="text" name="port2" size="2" maxlength="5" value="">
 </font></td>
 </tr>
 <tr> 
 <td width="14%"> 
 <div align="left"><font face="Arial" size="2">Schedule&nbsp;</font></div>
 </td>
 <td colspan="5"><font face="Arial" size="2"> 
 <input type="radio" name="schd" value="0">
 Always</font> </td>
 </tr>
 <tr> 
 <td width="14%">&nbsp;</td>
 <td width="12%"><font face="Arial" size="2"> 
 <input type="radio" name="schd" value="1">
 From</font></td>
 <td colspan="4"><font face="Arial" size="2"> time 
 <select size=1 name=hour1>
 <option value=0>00</option>
 <option value=1>01</option>
 <option value=2>02</option>
 <option value=3>03</option>
 <option value=4>04</option>
 <option value=5>05</option>
 <option value=6>06</option>
 <option value=7>07</option>
 <option value=8>08</option>
 <option value=9>09</option>
 <option value=10>10</option>
 <option value=11>11</option>
 </select>
 : 
 <select size=1 name=min1>
 <option value="0">00</option>
 <option value="5">05</option>
 <option value="10">10</option>
 <option value="15">15</option>
 <option value="20">20</option>
 <option value="25">25</option>
 <option value="30">30</option>
 <option value="35">35</option>
 <option value="40">40</option>
 <option value="45">45</option>
 <option value="50">50</option>
 <option value="55">55</option>
 </select>
 <select size=1 name=am1>
 <option value=0>AM</option>
 <option value=1>PM</option>
 </select>
 to 
 <select size=1 name=hour2>
 <option value=0>00</option>
 <option value=1>01</option>
 <option value=2>02</option>
 <option value=3>03</option>
 <option value=4>04</option>
 <option value=5>05</option>
 <option value=6>06</option>
 <option value=7>07</option>
 <option value=8>08</option>
 <option value=9>09</option>
 <option value=10>10</option>
 <option value=11>11</option>
 </select>
 : 
 <select size=1 name=min2>
 <option value="0">00</option>
 <option value="5">05</option>
 <option value="10">10</option>
 <option value="15">15</option>
 <option value="20">20</option>
 <option value="25">25</option>
 <option value="30">30</option>
 <option value="35">35</option>
 <option value="40">40</option>
 <option value="45">45</option>
 <option value="50">50</option>
 <option value="55">55</option>
 </select>
 <select size=1 name=am2>
 <option value=0>AM</option>
 <option value=1>PM</option>
 </select>
 </font></td>
 </tr>
 <tr> 
 <td colspan="2">&nbsp;</td>
 <td colspan="4"><font face="Arial" size="2">day 
 <select size=1 name=day1>
 <option value=0>Sun</option>
 <option value=1>Mon</option>
 <option value=2>Tue</option>
 <option value=3>Wed</option>
 <option value=4>Thu</option>
 <option value=5>Fri</option>
 <option value=6>Sat</option>
 </select>
 to 
 <select size=1 name=day2>
 <option value=0>Sun</option>
 <option value=1>Mon</option>
 <option value=2>Tue</option>
 <option value=3>Wed</option>
 <option value=4>Thu</option>
 <option value=5>Fri</option>
 <option value=6>Sat</option>
 </select>
 </font></td>
 </tr>
 <tr> 
 <td colspan="3" valign="bottom"><font face="Arial" size="2" color="#8babc1"><b>Firewall 
 Rules List</b></font></td>
 <td colspan="3" valign="bottom"> 
 <table width="40%" border="0" cellspacing="0" cellpadding="0" align="right">
 <tr> 
 <td><font size="2"><a href="javascript:document.forms[0].submit()"><img src="apply_p.jpg" width="51" height="52" border="0"></a></font></td>
 <td><font size="2"><a href="adv_firewall.html"><img src="cancel_p.jpg" width="51" height="52" border="0"></a></font></td>
 <td><font size="2"><a href="help_adv.html#08" target="_blank"><img src="help_p.jpg" width="36" height="52" border="0"></a></font></td>
 </tr>
 </table>
 </td>
 </tr>
 </table>
 <table border="0" width="100%" id="tabRule" cellpadding="0" cellspacing="0">
 <tr bgcolor="#B7DCFB"> 
 <td>&nbsp;</td>
 <td><font face="Arial" size="2" color="#333333">Action</font></td>
 <td><font face="Arial" size="2" color="#333333">Name</font></td>
 <td><font face="Arial" size="2" color="#333333">Source</font></td>
 <td><font face="Arial" size="2" color="#333333">Destination</font></td>
 <td><font face="Arial" size="2" color="#333333">Protocol</font></td>
 <td>&nbsp;</td>
 </tr>
 <tr><td><input type="checkbox" name="e0"  checked disabled></td><td><font face="Arial" size="2">Allow</font></td><td><font face="Arial" size="2">Allow to Ping WAN port</font></td><td><font face="Arial" size="2">WAN,*</font></td><td><font face="Arial" size="2">LAN,192.168.0.30</font></td><td><font face="Arial" size="2">ICMP,8</font></td><td><font face="Arial" size="2"></font></td></tr>
<tr><td><input type="checkbox" name="e1"  checked disabled></td><td><font face="Arial" size="2">Deny</font></td><td><font face="Arial" size="2">Default</font></td><td><font face="Arial" size="2">*,*</font></td><td><font face="Arial" size="2">LAN,*</font></td><td><font face="Arial" size="2">*,*</font></td><td><font face="Arial" size="2"></font></td></tr>
<tr><td><input type="checkbox" name="e2"  checked disabled></td><td><font face="Arial" size="2">Allow</font></td><td><font face="Arial" size="2">Default</font></td><td><font face="Arial" size="2">LAN,*</font></td><td><font face="Arial" size="2">*,*</font></td><td><font face="Arial" size="2">*,*</font></td><td><font face="Arial" size="2"></font></td></tr>

 </table>
 </form>
 </td>
 <td width="19"> <img src="down_10.jpg" width=19 height=26></td>
 <td width="25" background="down_11.gif">&nbsp; </td>
 </tr>
 <tr> 
 <td width="133" height="42" bgcolor="#CCCCCC"><a href="adv_virtual.html"><img src="advhtml_12.jpg" width="133" height="57" border="0"></a></td>
 <td width="25" background="down_03.jpg" height="42">&nbsp; </td>
 <td width="21" background="down_14.gif" height="42">&nbsp; </td>
 <td width="19" background="down_40.gif" height="42">&nbsp; </td>
 <td width="25" background="down_11.gif" height="42">&nbsp; </td>
 </tr>
 <tr> 
 <td width="133" bgcolor="#CCCCCC"><a href="adv_appl.html"><img src="advhtml_17.jpg" width="133" height="56" border="0"></a></td>
 <td width="25" background="down_03.jpg">&nbsp; </td>
 <td width="21" background="down_14.gif">&nbsp; </td>
 <td width="19" background="down_40.gif">&nbsp; </td>
 <td width="25" background="down_11.gif">&nbsp; </td>
 </tr>
 <tr> 
 <td width="133" bgcolor="#CCCCCC"><a href="adv_filters.html"><img src="advhtml_22.jpg" width="133" height="56" border="0"></a> 
 </td>
 <td width="25" background="down_03.jpg">&nbsp; </td>
 <td width="21" background="down_14.gif">&nbsp; </td>
 <td width="19" background="down_40.gif">&nbsp; </td>
 <td width="25" background="down_11.gif">&nbsp; </td>
 </tr>
 <tr> 
 <td width="133" bgcolor="#CCCCCC"><a href="adv_firewall.html"><img src="adv_over_27.jpg" width="133" height="56" border="0"></a></td>
 <td width="25" background="down_03.jpg">&nbsp; </td>
 <td width="21" background="down_14.gif">&nbsp; </td>
 <td width="19" background="down_40.gif">&nbsp; </td>
 <td width="25" background="down_11.gif">&nbsp; </td>
 </tr>
 <tr> 
 <td width="133" bgcolor="#CCCCCC"><a href="adv_dmz.html"><img src="adv_dmz.jpg" width="133" height="56" border="0"></a> 
 </td>
 <td width="25" background="down_03.jpg" rowspan="2">&nbsp; </td>
 <td width="21" background="down_14.gif" rowspan="2">&nbsp; </td>
 <td width="19" background="down_40.gif" rowspan="2">&nbsp; </td>
 <td width="25" background="down_11.gif" rowspan="2">&nbsp; </td>
 </tr>
 <tr>
 <td width="133" bgcolor="#CCCCCC"><a href="adv_perform.html"><img src="adv_pf.jpg" width="133" height="56" border="0"></a></td>
 </tr>
 <tr> 
 <td width="133" background="down_37.gif" height="50"></td>
 <td width="25" background="down_03.jpg"><br><br><br><br><br><br><br><br><br><br><br><br>
 <br><br><br><br><br><br>
 </td>
 <td width="21" background="down_14.gif">&nbsp; </td>
 <td width="19" background="down_40.gif">&nbsp; </td>
 <td width="25" background="down_11.gif">&nbsp; </td>
 </tr>
 <tr> 
 <td colspan=6 rowspan=2> <img src="down_43.jpg" width=740 height=44></td>
 <td width="25"> <img src="down_43.gif" width="25" height="17"></td>
 </tr>
 <tr> 
 <td width="25"> <img src="down_44.gif" width=25 height=27></td>
 </tr>
 </table>
 <map name="MapMap"> 
 <area shape="rect" coords="17,17,82,45" href="h_wizard.html" target="_self">
 <area shape="rect" coords="109,18,205,42" href="adv_virtual.html" target="_self">
 <area shape="rect" coords="232,19,289,46" href="tools_admin.html" target="_self">
 <area shape="rect" coords="346,18,405,45" href="st_device.html" target="_self">
 <area shape="rect" coords="455,18,501,47" href="help_men.html">
 </map>
 </td>
 </tr>
</table>
<map name="Map2">
 <area shape="rect" coords="18,8,152,60" href="http://www.dlink.com.tw" target="_blank">
</map>
</BODY>
</HTML>
